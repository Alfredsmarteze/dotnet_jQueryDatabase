@model dotnet_webgrid.Models.User
@{ ViewData["Title"] = "Home Page"; }
@*<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.11.3/af-2.3.7/b-2.0.1/b-colvis-2.0.1/r-2.2.9/datatables.min.css" />*@
@*<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">*@
@*<link href="//cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css" />*@
@*<link href="//cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css" />*@
@*<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/r/dt/jq-2.1.4,jszip-2.5.0,pdfmake-0.1.18,dt-1.10.9,af-2.0.0,b-1.0.3,b-colvis-1.0.3,b-html5-1.0.3,b-print-1.0.3,se-1.0.1/datatables.min.css" />*@
@*<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">*@
@*<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css">*@

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.4.0/css/buttons.dataTables.min.css" />




<h4>User</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Index">
            <input type="hidden" asp-for="ID" />
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="FirstName" class="control-label"></label>
                <input asp-for="FirstName" class="form-control" />
                <span asp-validation-for="FirstName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="LastName" class="control-label"></label>
                <input asp-for="LastName" class="form-control" />
                <span asp-validation-for="LastName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="MiddleName" class="control-label"></label>
                <input asp-for="MiddleName" class="form-control" />
                <span asp-validation-for="MiddleName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Contact" class="control-label"></label>
                <input asp-for="Contact" class="form-control" />
                <span asp-validation-for="Contact" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Save" class="btn btn-primary" />
            </div>
        </form>

    </div>



</div>

<br>

<br>
@*<button class="btn btn-danger btn-lg" onclick="DeleteAllRow(this)">Delete All Record</button>*@
<div class="text-center">
    <table id="userTable" class="table table-striped table-bordered" style="width:100%">
        <thead>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

@*<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>*@
@*<script src="https://cdn.jsdelivr.net/npm/pretty-print-json@1.1.0/dist/pretty-print-json.min.js"></script>*@
@*<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="//cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>*@
@*<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.11.3/af-2.3.7/b-2.0.1/b-colvis-2.0.1/r-2.2.9/datatables.min.js"></script>*@


@*<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>*@
@*<script type="text/javascript" src="https://cdn.datatables.net/r/dt/jq-2.1.4,jszip-2.5.0,pdfmake-0.1.18,dt-1.10.9,af-2.0.0,b-1.0.3,b-colvis-1.0.3,b-html5-1.0.3,b-print-1.0.3,se-1.0.1/datatables.min.js"></script>*@

@*<script src="https://cdn.datatables.net/buttons/2.0.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>*@


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/pdfmake.min.js"></script>
<script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.4.0/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.flash.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.print.min.js"></script>




<script src="~/lib/notify.min.js"></script>
<script type="text/javascript">

    function editUser(element) {
        $("input[name='ID']").val(element.dataset.id);
        $("input[name='FirstName']").val(element.dataset.firstname);
        $("input[name='LastName']").val(element.dataset.lastname);
        $("input[name='MiddleName']").val(element.dataset.middlename);
        $("input[name='Contact']").val(element.dataset.contact);

    }

    function DeleteRow(id)
        {
            if (confirm("Are You sure to delete this record..?")) {
                $.ajax({

                    type: 'POST',
                    url: '@Url.Action("deleteuser", "home")/'+id,
                    datatype: 'JSON',
                    //data: JSON.stringify({ id: id }),
                    success: function (response) {
                        if (response.success) {
                            $.notify(response.message, {
                                globalPosition: "top centre",
                                className: "sucess"
                            });
                            window.location.reload();
                        }
                            table.row().remove().draw();
                            //table.ajax.reload();

                            //$("#myModal").modal('hide');

                    },
                });
            }
    }
    function DeleteAllRow(id)
    {
        $.ajax({
            type: 'POST',
            url: '@Url.Action("DeleteAll","Home")/' + id,
            datatype: 'JSON',
            success: function (data)
            {
                if (data.success) {
                    $.notify(data.message, {
                        globalPosition: "top centre",
                        className: "Success"
                    });
                }
            }
        })
    }

    $(document).ready(function () {
        var printCounter = 0;
        var table = $('#userTable').DataTable({
            "processing": true,
            /* "serverSide": true,*/
            "filter": true,
            "orderMulti": false, // for disable multiple column at once
            "ajax": {
                'url': '@Url.Action("getAllUsers", "Home")',
                "type": "GET",
                "datatype": "json"

            },

            ////"dom": 'lBfrtip',
            ////buttons: [
            ////    {
            ////        extend: 'excelHtml5',
            ////        text: 'Export to Excel',
            ////        title: 'Learn Export : Export to Excel',
            ////        download: 'open',
            ////        orientation: 'landscape',
            ////        exportOptions: {
            ////            columns: ':visible'
            ////        }
            ////    }],
            "dom": 'Bfrtip',
            buttons: [
                {
                    extend: 'copy',
                    exportOptions: {
                        columns: [2, 0, 3, ':visible']
                    },
                    title:'Learning DataTable Export'
                },
                {
                    extend: 'excel',
                    text: 'Export to Excel',
                    exportOptions: {
                        columns: ':visible'
                    }
                },
                {
                    extend: 'pdf',
                    orientation: 'landscape',
                    exportOptions: {
                        columns: [0, 1, 2]
                    },
                    title: 'Learning DataTable Export',
                    /*download:'open'*/
                },
                {
                    extend: 'csv',
                    exportOptions: {
                        columns:':visible'
                    },
                    title: 'Learning DataTable Export'
                },
                {
                    extend: 'print',
                    exportOptions: {
                        columns:[0,1,2,3,4]
                    },
                    title: 'Learning DataTable Export',
                    messageTop: function () {
                        printCounter++;

                        if (printCounter === 1) {
                            return 'This is the first time you have printed this document.';
                        }
                        else {
                            return 'You have printed this document ' + printCounter + ' times';
                        }
                    },
                    messageBottom: null
                }
               /* 'colvis'*/
            ],

            //dom: 'Bfrtip',
            //buttons: [
            //    'copy', 'csv', 'excel', 'pdf', 'print'

            //],


            "columns": [

                { "sTitle": "ID", "data": "id" },
                { "sTitle": "First Name", "data": "firstName" },
                { "sTitle": "Last Name", "data": "lastName" },
                { "sTitle": "Middle Name", "data": "middleName" },
                { "sTitle": "Contact", "data": "contact" },
                {
                    "sTitle": "Action",
                    "render": function (data, type, row, meta) {
                        console.log(row);

                        if (row) {

                            return `<button class="btn btn-primary"

                                                    data-firstName="${row.firstName}"
                                                    data-lastName="${row.lastName}"
                                                    data-middleName="${row.middleName}"
                                                    data-contact="${row.contact}"
                                                    data-id="${row.id}"
                                                    onclick="editUser(this)">Edit</button>

                                                    <button class=" btn btn-danger"
                                                    data-firstName="${row.firstName}"
                                                    data-lastName="${row.lastName}"
                                                    data-middleName="${row.middleName}"
                                                    data-contact="${row.contact}"
                                                    data-id="${row.id}"
                                                    onclick='DeleteRow(${row.id})'>Delete</button>

                                                    <button class=" btn btn-danger"
                                                    data-firstName="${row.firstName}"
                                                    data-lastName="${row.lastName}"
                                                    data-middleName="${row.middleName}"
                                                    data-contact="${row.contact}"
                                                    data-id="${row.id}"
                                                    onclick='DeleteAllRow(${row.id})'>WipeOfffAllData</button>`
                             }

                        return '';
                    },
                },]
        });

         //Selected row
         $('tbody').on('click', 'tr', function () {
            if ($(this).hasClass('selected')) {
                $(this).removeClass('selected');
            }
            else {
                table.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');

            }
         });
        //$('.btn-danger').on('click', function () {
        //    table.row('.selected').remove().draw(true);

        //});
     });






</script>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}